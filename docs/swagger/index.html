<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accessibility Platform API - Documentaci√≥n Completa</title>
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/swagger-ui-dist@5.10.5/swagger-ui.css" />
    <link rel="icon" type="image/png" href="https://unpkg.com/swagger-ui-dist@5.10.5/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="https://unpkg.com/swagger-ui-dist@5.10.5/favicon-16x16.png" sizes="16x16" />
    <style>
        html {
            box-sizing: border-box;
            overflow: -moz-scrollbars-vertical;
            overflow-y: scroll;
        }

        *,
        *:before,
        *:after {
            box-sizing: inherit;
        }

        body {
            margin: 0;
            background: #fafafa;
            font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
        }

        #swagger-ui {
            max-width: 1400px;
            margin: 0 auto;
        }

        .swagger-ui .topbar {
            background-color: #2c3e50;
            border-bottom: 3px solid #3498db;
        }

        .swagger-ui .topbar .link {
            content: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="40" viewBox="0 0 100 40"><text x="10" y="25" font-family="Arial" font-size="16" fill="white">API Gateway</text></svg>');
        }

        .custom-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            text-align: center;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .custom-header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 300;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .custom-header p {
            margin: 1rem 0 0 0;
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto 2rem auto;
        }

        .feature-card {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #3498db;
        }

        .feature-card h3 {
            color: #2c3e50;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .feature-card ul {
            list-style: none;
            padding: 0;
        }

        .feature-card li {
            padding: 0.25rem 0;
            padding-left: 1rem;
            position: relative;
        }

        .feature-card li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #27ae60;
            font-weight: bold;
        }

        .auth-notice {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 2rem 2rem 2rem;
            color: #856404;
        }

        .auth-notice h4 {
            margin-top: 0;
            color: #856404;
        }

        .auth-notice code {
            background: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .rate-limit-info {
            background: #e3f2fd;
            border: 1px solid #90caf9;
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 2rem 2rem 2rem;
            color: #0d47a1;
        }

        .rate-limit-info h4 {
            margin-top: 0;
            color: #0d47a1;
        }

        @media (max-width: 768px) {
            .custom-header h1 {
                font-size: 2rem;
            }

            .custom-header p {
                font-size: 1rem;
            }

            .features-grid {
                grid-template-columns: 1fr;
                padding: 1rem;
            }
        }

        /* Swagger UI Customizations */
        .swagger-ui .info .title {
            color: #2c3e50;
        }

        .swagger-ui .scheme-container {
            background: #f8f9fa;
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .swagger-ui .btn.authorize {
            background-color: #27ae60;
            border-color: #27ae60;
        }

        .swagger-ui .btn.authorize:hover {
            background-color: #229954;
            border-color: #229954;
        }

        .swagger-ui .opblock.opblock-post {
            border-color: #27ae60;
        }

        .swagger-ui .opblock.opblock-post .opblock-summary {
            border-color: #27ae60;
        }

        .swagger-ui .opblock.opblock-get {
            border-color: #3498db;
        }

        .swagger-ui .opblock.opblock-get .opblock-summary {
            border-color: #3498db;
        }

        .swagger-ui .opblock.opblock-put {
            border-color: #f39c12;
        }

        .swagger-ui .opblock.opblock-put .opblock-summary {
            border-color: #f39c12;
        }

        .swagger-ui .opblock.opblock-delete {
            border-color: #e74c3c;
        }

        .swagger-ui .opblock.opblock-delete .opblock-summary {
            border-color: #e74c3c;
        }
    </style>
</head>

<body>
    <div class="custom-header">
        <h1>üåê Accessibility Platform API Gateway</h1>
        <p>Documentaci√≥n completa de la API unificada para an√°lisis de accesibilidad web con m√∫ltiples microservicios y
            herramientas especializadas</p>
    </div>

    <div class="features-grid">
        <div class="feature-card">
            <h3>üîê Autenticaci√≥n JWT</h3>
            <ul>
                <li>Tokens JWT seguros</li>
                <li>Renovaci√≥n autom√°tica</li>
                <li>Roles y permisos</li>
                <li>Sesiones persistentes</li>
            </ul>
        </div>

        <div class="feature-card">
            <h3>‚ö° Rate Limiting</h3>
            <ul>
                <li>100 req/min general</li>
                <li>20 req/min an√°lisis</li>
                <li>Protecci√≥n DDoS</li>
                <li>L√≠mites por IP</li>
            </ul>
        </div>

        <div class="feature-card">
            <h3>üìä Microservicios</h3>
            <ul>
                <li>Users - Gesti√≥n usuarios</li>
                <li>Reports - Generaci√≥n reportes</li>
                <li>Analysis - An√°lisis est√°ndar</li>
                <li>Middleware - Herramientas avanzadas</li>
            </ul>
        </div>

        <div class="feature-card">
            <h3>üõ†Ô∏è Herramientas</h3>
            <ul>
                <li>Axe - Core accessibility</li>
                <li>Equal Access - IBM Watson</li>
                <li>WCAG A/AA/AAA</li>
                <li>Screenshots autom√°ticas</li>
            </ul>
        </div>

        <div class="feature-card">
            <h3>üìà Monitoreo</h3>
            <ul>
                <li>Health checks detallados</li>
                <li>M√©tricas en tiempo real</li>
                <li>Logs estructurados</li>
                <li>Alertas autom√°ticas</li>
            </ul>
        </div>

        <div class="feature-card">
            <h3>üíæ Cach√© Inteligente</h3>
            <ul>
                <li>Redis distribuido</li>
                <li>Expiraci√≥n configurable</li>
                <li>Invalidaci√≥n autom√°tica</li>
                <li>Optimizaci√≥n rendimiento</li>
            </ul>
        </div>
    </div>

    <div class="auth-notice">
        <h4>üîë Autenticaci√≥n Requerida</h4>
        <p>La mayor√≠a de endpoints requieren autenticaci√≥n JWT. Para probar la API:</p>
        <ol>
            <li>Usa el endpoint <code>POST /api/v1/translate</code> con servicio <code>users</code> y path
                <code>/api/v1/auth/login</code>
            </li>
            <li>Copia el token de la respuesta</li>
            <li>Haz clic en "Authorize" arriba y pega: <code>Bearer &lt;tu-token&gt;</code></li>
            <li>Ya puedes usar todos los endpoints protegidos</li>
        </ol>
    </div>

    <div class="rate-limit-info">
        <h4>‚ö†Ô∏è L√≠mites de Velocidad</h4>
        <p><strong>General:</strong> 100 requests/minuto por IP<br>
            <strong>An√°lisis:</strong> 20 requests/minuto por IP (endpoints computacionalmente intensivos)<br>
            Los l√≠mites se reinician cada minuto y son por direcci√≥n IP.
        </p>
    </div>

    <div id="swagger-ui"></div>

    <script src="https://unpkg.com/swagger-ui-dist@5.10.5/swagger-ui-bundle.js" charset="UTF-8"></script>
    <script src="https://unpkg.com/swagger-ui-dist@5.10.5/swagger-ui-standalone-preset.js" charset="UTF-8"></script>
    <script>
        window.onload = function () {
            // Configuraci√≥n de Swagger UI
            SwaggerUIBundle({
                url: './gateway-complete-api.yaml',
                dom_id: '#swagger-ui',
                deepLinking: true,
                presets: [
                    SwaggerUIBundle.presets.apis,
                    SwaggerUIStandalonePreset
                ],
                plugins: [
                    SwaggerUIBundle.plugins.DownloadUrl
                ],
                layout: "StandaloneLayout",
                defaultModelsExpandDepth: 1,
                defaultModelExpandDepth: 3,
                docExpansion: "none",
                operationsSorter: "alpha",
                filter: true,
                tryItOutEnabled: true,
                requestInterceptor: function (request) {
                    // Agregar headers personalizados si es necesario
                    request.headers['X-API-Version'] = 'v1.0.0';
                    return request;
                },
                responseInterceptor: function (response) {
                    // Procesar respuestas si es necesario
                    return response;
                },
                onComplete: function () {
                    console.log("Swagger UI cargado completamente");
                },
                onFailure: function (error) {
                    console.error("Error cargando Swagger UI:", error);
                },
                requestSnippetsEnabled: true,
                requestSnippets: {
                    generators: {
                        "curl_bash": {
                            title: "cURL (bash)",
                            syntax: "bash"
                        },
                        "curl_powershell": {
                            title: "cURL (PowerShell)",
                            syntax: "powershell"
                        },
                        "javascript_fetch": {
                            title: "JavaScript (fetch)",
                            syntax: "javascript"
                        },
                        "python_requests": {
                            title: "Python (requests)",
                            syntax: "python"
                        },
                        "csharp_httpclient": {
                            title: "C# (HttpClient)",
                            syntax: "csharp"
                        }
                    },
                    defaultExpanded: false,
                    languages: null
                }
            });

            // Personalizaci√≥n adicional despu√©s de cargar
            setTimeout(function () {
                // Agregar informaci√≥n de versi√≥n en el footer
                const footer = document.createElement('div');
                footer.style.textAlign = 'center';
                footer.style.padding = '2rem';
                footer.style.backgroundColor = '#f8f9fa';
                footer.style.borderTop = '1px solid #dee2e6';
                footer.style.marginTop = '2rem';
                footer.innerHTML = `
                    <p style="margin: 0; color: #6c757d;">
                        <strong>Accessibility Platform API Gateway v1.0.0</strong><br>
                        Documentaci√≥n generada autom√°ticamente ‚Ä¢ 
                        <a href="mailto:accessibility@company.com" style="color: #007bff;">Soporte t√©cnico</a> ‚Ä¢ 
                        <a href="https://github.com/company/accessibility-platform" style="color: #007bff;">GitHub</a>
                    </p>
                `;
                document.body.appendChild(footer);

                // Scroll suave para enlaces internos
                document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                    anchor.addEventListener('click', function (e) {
                        e.preventDefault();
                        const target = document.querySelector(this.getAttribute('href'));
                        if (target) {
                            target.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                        }
                    });
                });
            }, 2000);
        };

        // Funci√≥n para mostrar ejemplos de uso
        function showUsageExamples() {
            const examples = `
                    // Ejemplo 1: Autenticaci√≥n
                    fetch('/api/v1/translate', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            service: 'users',
                            method: 'POST',
                            path: '/api/v1/auth/login',
                            body: {
                                email: 'usuario@example.com',
                                password: 'password123'
                            }
                        })
                    });

                    // Ejemplo 2: An√°lisis de URL
                    fetch('/api/v1/translate', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': 'Bearer your-jwt-token'
                        },
                        body: JSON.stringify({
                            service: 'middleware',
                            method: 'POST',
                            path: '/api/v1/analyze/url',
                            body: {
                                url: 'https://example.com',
                                tools: ['axe', 'equalAccess'],
                                wcagLevel: 'AA',
                                includeScreenshot: true
                            }
                        })
                    });

                    // Ejemplo 3: Crear reporte
                    fetch('/api/v1/translate', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': 'Bearer your-jwt-token'
                        },
                        body: JSON.stringify({
                            service: 'reports',
                            method: 'POST',
                            path: '/api/v1/reports',
                            body: {
                                title: 'Reporte de Accesibilidad',
                                description: 'An√°lisis completo de la homepage',
                                analysisId: 123
                            }
                        })
                    });
            `;

            console.log("Ejemplos de uso:", examples);
            alert("Revisa la consola del navegador para ver ejemplos de c√≥digo JavaScript");
        }

        // Funci√≥n para validar tokens JWT (simulada)
        function validateJWT(token) {
            if (!token || !token.startsWith('Bearer ')) {
                return false;
            }

            const jwt = token.substring(7);
            try {
                // Validaci√≥n b√°sica del formato JWT
                const parts = jwt.split('.');
                return parts.length === 3;
            } catch (e) {
                return false;
            }
        }

        // Agregar funcionalidad de ayuda
        document.addEventListener('keydown', function (e) {
            if (e.key === 'F1' || (e.ctrlKey && e.key === '?')) {
                e.preventDefault();
                showUsageExamples();
            }
        });
    </script>
</body>

</html>